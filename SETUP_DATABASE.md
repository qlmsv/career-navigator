# Настройка базы данных для Карьерного навигатора

## Проблема
При попытке использовать самодиагностику навыков возникает ошибка:
```
Error: Ошибка получения регионов: Could not find the table 'public.regions' in the schema cache
```

Это означает, что новые таблицы для системы самодиагностики не созданы в Supabase.

## Решение

### ⚡ САМОЕ ПРОСТОЕ РЕШЕНИЕ (30 секунд)

**ЕСЛИ БЫЛА ОШИБКА СИНТАКСИСА:**

1. **Откройте Supabase Dashboard**
   - Перейдите на https://supabase.com/dashboard
   - Выберите ваш проект

2. **Откройте SQL Editor**
   - В боковом меню выберите "SQL Editor"
   - Нажмите "New query"

3. **Используйте базовый файл:**
   - Откройте файл `setup_database_basic.sql` ⭐
   - Скопируйте **ВЕСЬ** код (Ctrl+A, Ctrl+C)
   - Вставьте в SQL Editor (Ctrl+V)
   - Нажмите зеленую кнопку **"Run"**

4. **Увидите результат:**
   ```
   status: "Успешно настроено!"
   categories_count: 6
   skills_count: 6  
   regions_count: 5
   professions_count: 5
   ```

5. **Обновите страницу** `/skills-assessment` - ошибка исчезнет!

### Альтернатива: Минимальный файл

Если `setup_database_basic.sql` не работает, используйте `setup_database_minimal.sql` (с исправленными политиками).

### Вариант 2: Пошагово (если есть ошибки)

Если простой SQL не работает, выполните по частям:
1. Сначала создайте таблицы (только CREATE TABLE части)
2. Затем добавьте данные (только INSERT части)
3. В конце настройте RLS политики

### Вариант 2: Через Supabase CLI (для разработчиков)

```bash
# Установите Supabase CLI (если не установлен)
npm install -g supabase

# Войдите в аккаунт
supabase login

# Свяжите проект
supabase link --project-ref YOUR_PROJECT_REF

# Примените миграции
supabase db push
```

### Вариант 3: Ручное создание (если миграции не работают)

Если автоматические миграции не работают, создайте таблицы вручную:

1. В SQL Editor выполните команды создания таблиц по одной
2. Сначала создайте основные таблицы (categories, regions, professions)
3. Затем зависимые таблицы (skills, assessments)
4. Наконец, заполните начальными данными

## Проверка

После выполнения миграций:

1. Обновите страницу `/skills-assessment`
2. Ошибка должна исчезнуть
3. Должны загрузиться формы с выбором профессий и регионов

## Структура новых таблиц

- **digital_skill_categories** - категории навыков (6 категорий)
- **digital_skills** - конкретные навыки (24 навыка)
- **regions** - регионы России (15 регионов)
- **professions** - профессии не ИКТ (20+ профессий)
- **user_skill_assessments** - результаты самодиагностики
- **learning_resources** - образовательные ресурсы

## Если проблемы остаются

1. Проверьте права доступа к БД в Supabase
2. Убедитесь, что RLS политики настроены правильно
3. Проверьте логи ошибок в Supabase Dashboard
4. Обратитесь к разработчику за помощью

---

**Важно:** После настройки БД все функции самодиагностики будут работать корректно.
